<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=46479&amp;path=livereload" data-no-instant defer></script>
  <title>
   · 思考のAPI
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="0xchoux1">
<meta name="description" content="MCPサーバーのPython実装：基本クラス構造 Link to heading はじめに Link to heading 前回の記事で設計した基本構造に基づいて、MCPサーバーの基本クラス構造を実装しました。この記事では、実装の詳細と設計の意図について説明します。
実装の概要 Link to heading プロジェクトは以下の3つの主要なファイルで構成されています：
models.py: データモデルの定義 server.py: MCPサーバーの基本クラス main.py: FastAPIを使用したHTTPサーバー データモデルの実装 Link to heading models.pyでは、Pydanticを使用して型安全なデータモデルを定義しています：
1class ServerCapabilities(BaseModel): 2 &#34;&#34;&#34;サーバーの機能を定義するモデル&#34;&#34;&#34; 3 logging: Dict[str, Any] = {} 4 completions: Dict[str, Any] = {} 5 prompts: Dict[str, bool] = {&#34;listChanged&#34;: True} 6 resources: Dict[str, bool] = {&#34;subscribe&#34;: True, &#34;listChanged&#34;: True} 7 tools: Dict[str, bool] = {&#34;listChanged&#34;: True} Pydanticを使用する利点：
自動的なバリデーション 型の安全性 JSONシリアライズ/デシリアライズの自動化 サーバークラスの実装 Link to heading server.">
<meta name="keywords" content="blog,技術,学び,アウトプット">


<meta name="twitter:card" content="summary"><meta name="twitter:title" content="">
<meta name="twitter:description" content="MCPサーバーのPython実装：基本クラス構造 Link to heading はじめに Link to heading 前回の記事で設計した基本構造に基づいて、MCPサーバーの基本クラス構造を実装しました。この記事では、実装の詳細と設計の意図について説明します。
実装の概要 Link to heading プロジェクトは以下の3つの主要なファイルで構成されています：
models.py: データモデルの定義 server.py: MCPサーバーの基本クラス main.py: FastAPIを使用したHTTPサーバー データモデルの実装 Link to heading models.pyでは、Pydanticを使用して型安全なデータモデルを定義しています：
1class ServerCapabilities(BaseModel): 2 &#34;&#34;&#34;サーバーの機能を定義するモデル&#34;&#34;&#34; 3 logging: Dict[str, Any] = {} 4 completions: Dict[str, Any] = {} 5 prompts: Dict[str, bool] = {&#34;listChanged&#34;: True} 6 resources: Dict[str, bool] = {&#34;subscribe&#34;: True, &#34;listChanged&#34;: True} 7 tools: Dict[str, bool] = {&#34;listChanged&#34;: True} Pydanticを使用する利点：
自動的なバリデーション 型の安全性 JSONシリアライズ/デシリアライズの自動化 サーバークラスの実装 Link to heading server.">

<meta property="og:url" content="//localhost:46479/posts/2025-05-06-mcp-server-python-basic-implementation/">
  <meta property="og:site_name" content="思考のAPI">
  <meta property="og:title" content="思考のAPI">
  <meta property="og:description" content="MCPサーバーのPython実装：基本クラス構造 Link to heading はじめに Link to heading 前回の記事で設計した基本構造に基づいて、MCPサーバーの基本クラス構造を実装しました。この記事では、実装の詳細と設計の意図について説明します。
実装の概要 Link to heading プロジェクトは以下の3つの主要なファイルで構成されています：
models.py: データモデルの定義 server.py: MCPサーバーの基本クラス main.py: FastAPIを使用したHTTPサーバー データモデルの実装 Link to heading models.pyでは、Pydanticを使用して型安全なデータモデルを定義しています：
1class ServerCapabilities(BaseModel): 2 &#34;&#34;&#34;サーバーの機能を定義するモデル&#34;&#34;&#34; 3 logging: Dict[str, Any] = {} 4 completions: Dict[str, Any] = {} 5 prompts: Dict[str, bool] = {&#34;listChanged&#34;: True} 6 resources: Dict[str, bool] = {&#34;subscribe&#34;: True, &#34;listChanged&#34;: True} 7 tools: Dict[str, bool] = {&#34;listChanged&#34;: True} Pydanticを使用する利点：
自動的なバリデーション 型の安全性 JSONシリアライズ/デシリアライズの自動化 サーバークラスの実装 Link to heading server.">
  <meta property="og:locale" content="ja-jp">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">




<link rel="canonical" href="//localhost:46479/posts/2025-05-06-mcp-server-python-basic-implementation/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="//localhost:46479/">
      思考のAPI
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/">ホーム</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="//localhost:46479/posts/2025-05-06-mcp-server-python-basic-implementation/">
              
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="0001-01-01T00:00:00Z">
                January 1, 0001
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              One-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <h1 id="mcpサーバーのpython実装基本クラス構造">
  MCPサーバーのPython実装：基本クラス構造
  <a class="heading-link" href="#mcp%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e3%81%aepython%e5%ae%9f%e8%a3%85%e5%9f%ba%e6%9c%ac%e3%82%af%e3%83%a9%e3%82%b9%e6%a7%8b%e9%80%a0">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<h2 id="はじめに">
  はじめに
  <a class="heading-link" href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>前回の記事で設計した基本構造に基づいて、MCPサーバーの基本クラス構造を実装しました。この記事では、実装の詳細と設計の意図について説明します。</p>
<h2 id="実装の概要">
  実装の概要
  <a class="heading-link" href="#%e5%ae%9f%e8%a3%85%e3%81%ae%e6%a6%82%e8%a6%81">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>プロジェクトは以下の3つの主要なファイルで構成されています：</p>
<ol>
<li><code>models.py</code>: データモデルの定義</li>
<li><code>server.py</code>: MCPサーバーの基本クラス</li>
<li><code>main.py</code>: FastAPIを使用したHTTPサーバー</li>
</ol>
<h2 id="データモデルの実装">
  データモデルの実装
  <a class="heading-link" href="#%e3%83%87%e3%83%bc%e3%82%bf%e3%83%a2%e3%83%87%e3%83%ab%e3%81%ae%e5%ae%9f%e8%a3%85">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p><code>models.py</code>では、Pydanticを使用して型安全なデータモデルを定義しています：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">class</span> <span class="nc">ServerCapabilities</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">    <span class="s2">&#34;&#34;&#34;サーバーの機能を定義するモデル&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">    <span class="n">logging</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">    <span class="n">completions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="n">prompts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;listChanged&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="n">resources</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;subscribe&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&#34;listChanged&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="n">tools</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;listChanged&#34;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span></span></code></pre></div><p>Pydanticを使用する利点：</p>
<ul>
<li>自動的なバリデーション</li>
<li>型の安全性</li>
<li>JSONシリアライズ/デシリアライズの自動化</li>
</ul>
<h2 id="サーバークラスの実装">
  サーバークラスの実装
  <a class="heading-link" href="#%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e3%82%af%e3%83%a9%e3%82%b9%e3%81%ae%e5%ae%9f%e8%a3%85">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p><code>server.py</code>では、MCPサーバーの基本機能を実装しています：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">class</span> <span class="nc">MCPServer</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">capabilities</span> <span class="o">=</span> <span class="n">ServerCapabilities</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">server_info</span> <span class="o">=</span> <span class="n">Implementation</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">            <span class="n">name</span><span class="o">=</span><span class="s2">&#34;MCP Basic Server&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">            <span class="n">version</span><span class="o">=</span><span class="s2">&#34;1.0.0&#34;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">protocol_version</span> <span class="o">=</span> <span class="s2">&#34;2025-03-26&#34;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">async</span> <span class="k">def</span> <span class="nf">handle_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">InitializeRequest</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InitializeResult</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="c1"># 初期化リクエストの処理</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="o">...</span>
</span></span></code></pre></div><p>主な特徴：</p>
<ul>
<li>非同期処理のサポート（<code>async/await</code>）</li>
<li>型ヒントによる安全性</li>
<li>明確な責務の分離</li>
</ul>
<h2 id="httpサーバーの実装">
  HTTPサーバーの実装
  <a class="heading-link" href="#http%e3%82%b5%e3%83%bc%e3%83%90%e3%83%bc%e3%81%ae%e5%ae%9f%e8%a3%85">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p><code>main.py</code>では、FastAPIを使用してHTTPサーバーを実装しています：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;MCP Basic Server&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">server</span> <span class="o">=</span> <span class="n">MCPServer</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">handle_request</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="c1"># リクエストの処理</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="o">...</span>
</span></span></code></pre></div><p>FastAPIの利点：</p>
<ul>
<li>自動的なAPIドキュメント生成</li>
<li>非同期処理のサポート</li>
<li>高速なパフォーマンス</li>
</ul>
<h2 id="次のステップ">
  次のステップ
  <a class="heading-link" href="#%e6%ac%a1%e3%81%ae%e3%82%b9%e3%83%86%e3%83%83%e3%83%97">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ol>
<li>
<p>エラーハンドリングの実装</p>
<ul>
<li>カスタム例外クラスの作成</li>
<li>エラーレスポンスの標準化</li>
</ul>
</li>
<li>
<p>ログ機能の追加</p>
<ul>
<li>構造化ログの実装</li>
<li>ログレベルの設定</li>
</ul>
</li>
<li>
<p>テストケースの作成</p>
<ul>
<li>ユニットテスト</li>
<li>統合テスト</li>
</ul>
</li>
</ol>
<blockquote>
<p><strong>注記</strong>
本記事はMCPサーバーの基本クラス構造にフォーカスしていますが、現状の実装では logger.py（ログ機能）や errors.py（エラーハンドリング）などの拡張ファイルも既に存在します。
これらの詳細については、今後の記事で順次解説していきます。</p>
</blockquote>
<h2 id="まとめ">
  まとめ
  <a class="heading-link" href="#%e3%81%be%e3%81%a8%e3%82%81">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>MCPサーバーの基本クラス構造を実装し、以下の機能を提供できるようになりました：</p>
<ul>
<li>型安全なデータモデル</li>
<li>非同期処理のサポート</li>
<li>HTTPエンドポイントの提供</li>
<li>初期化リクエストの処理</li>
</ul>
<p>次の記事では、エラーハンドリングの実装について説明します。</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
     0xchoux1 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
